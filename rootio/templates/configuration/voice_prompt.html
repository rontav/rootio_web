{% from "macros/_form.html" import render_form %}

{% extends "configuration/layout.html" %}



{% block js_top %}
    {{ super() }}
    
<script src="{{ url_for('static', filename='js/vendor/jquery-1.9.1.js') }}"></script>

<script type="text/javascript">
  $(document).ready(function() {
      toggleUseTts($(":checkbox[name='use_tts']").is(':checked'))

      $(":checkbox[name='use_tts']").click(function(){
          toggleUseTts($(this).is(':checked'))
      });

      $( "form[name='validate']" ).validate({ // initialize
            /* rules: {
                oneField: {
                // required: true,
                accept: "audio/wav, audio/mp3",
                maxsize: 10 * 1000 * 1000,
                }
            }, messages: {
                    test:{
                        maxsize:" file size must be less than 100 MB.",
                        accept:"Please upload .mp3 or .wav.",
                        required:"Please upload a file."
                    }
                }
            }); */
        });

        $('input[type="file"]').each(function() {
            $(this).rules('add', {
                accept: "audio/wav, audio/mp3",
                maxsize: 10 * 1000 * 1000,
                messages: {
                    maxsize:" file size must be less than 100 MB.",
                    accept:"Please upload .mp3 or .wav.",
                    required:"Please upload a file."
                }
            });
        });

    });

  function toggleUseTts(useTts)
  {
       if(useTts)
       {
           //disable all file inputs with their labels
           $(':file').parent().parent().css('display', 'none')


           //show TTS options
           $(":text[name$='txt']").parent().parent().css('display', 'block')
           $(":checkbox[name='prefetch_tts']").parent().parent().css('display', 'block')
       }
       else
       {
           //show all file inputs
           $(':file').parent().parent().css('display', 'block')

           //show TTS options
           $(":checkbox[name='prefetch_tts']").parent().parent().css('display', 'none')
           $(":text[name$='txt']").parent().parent().css('display', 'none')
       }
  }


</script>
{% endblock %}

{% block body %}
<div class="container">
    {%if voice_prompt %}
        <h2>{{ station.name }}</h2>
        {{ render_form(url_for('configuration.voice_prompt', voice_prompt_id=voice_prompt.id), form, validate=True) }}
    {%else%}
        <h2>{{ _('Add voice prompts') }}</h2>
        {{ render_form(url_for('configuration.voice_prompt'), form, validate=True) }}
    {%endif%}
</div>
{% endblock %}
